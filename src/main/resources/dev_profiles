create database dev_profiles_db;

create table accounts
(
    id         serial primary key,
    first_name text,
    last_name  text,
    city       text,
    gender     text,
    username   text NOT NULL
);

create table profiles_table
(
    id         serial primary key,
    username   text NOT NULL,
    job_title  text,
    department text,
    company    text,
    skill      text
);

alter table profiles_table
    rename to profiles;

--I
select *
from profiles
order by department, skill;

--II
select job_title
from profiles
group by job_title
having count(*) > 3;

--III
select first_name, last_name, job_title, company
from accounts
         join profiles p on accounts.id = p.id
order by city;

--IV
select job_title, count(job_title)
from accounts rigt
         join profiles p on rigt.id = p.id
group by job_title
order by count(job_title) desc;

--V
select department, count(username)
from profiles
group by department
order by count(username) desc
limit 1;

--VI
select *
from accounts
order by city;

--VII
update profiles
set job_title = replace(job_title, '%Engineer%', '%Developer%')
where job_title like '%Engineer%';